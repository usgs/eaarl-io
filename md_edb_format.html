<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eaarl-io: EDB File Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eaarl-io
   &#160;<span id="projectnumber">1.0.1+71abbd4</span>
   </div>
   <div id="projectbrief">EAARL Input/Output Library (Public API)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">EDB File Format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>EDB stands for "EAARL database". These files are also refered to as EAARL index files. The EDB file allows the user to quickly look up any raster record in a collection of TLD files. The EDB file also defines the raster numbers for a flight: a raster's raster number is its one-based index into the EDB file's records section.</p>
<h2>File Format</h2>
<p>The EDB file format has three sections:</p>
<ol type="1">
<li>Header, specifying the layout and contents of the file</li>
<li>Records, providing information about the rasters in the associated TLD files.</li>
<li>Filenames, providing the filenames for the associated TLD files (referenced by index from the records).</li>
</ol>
<p>The file stores values in little-endian format.</p>
<p>The file starts with the header. The records then immediately follow, starting at byte offset 12. The filenames are located at the <em>files_offset</em> specified in the header.</p>
<h3>Header</h3>
<p>The header specifies the layout and contents of the file.</p>
<p>The EDB's file header is 12 bytes long.</p>
<table class="doxtable">
<tr>
<th>Item </th><th>Format </th><th>Size  </th></tr>
<tr>
<td>files_offset </td><td>uint32_t </td><td>4 bytes </td></tr>
<tr>
<td>record_count </td><td>uint32_t </td><td>4 bytes </td></tr>
<tr>
<td>file_count </td><td>uint32_t </td><td>4 bytes </td></tr>
</table>
<ul>
<li><b>files_offset:</b> The offset into the file where the filenames portion of the file is stored. (This is typically equal to 12 + 20 * record_count, since the filenames usually start immediately after the records. However, this is not strictly enforced.)</li>
<li><b>record_count:</b> Number of records in the record section of the file.</li>
<li><b>file_count:</b> Number of filenames in the filenames section of the file.</li>
</ul>
<h3>Record</h3>
<p>Each record provides information about a single raster.</p>
<p>Each record is 20 bytes long.</p>
<table class="doxtable">
<tr>
<th>Item </th><th>Format </th><th>Size  </th></tr>
<tr>
<td>time_seconds </td><td>uint32_t </td><td>4 bytes </td></tr>
<tr>
<td>time_fraction </td><td>uint32_t </td><td>4 bytes </td></tr>
<tr>
<td>record_offset </td><td>uint32_t </td><td>4 bytes </td></tr>
<tr>
<td>record_length </td><td>uint32_t </td><td>4 bytes </td></tr>
<tr>
<td>file_index </td><td>int16_t </td><td>2 bytes </td></tr>
<tr>
<td>pulse_count </td><td>uint8_t </td><td>1 byte </td></tr>
<tr>
<td>digitizer </td><td>uint8_t </td><td>1 byte </td></tr>
</table>
<ul>
<li><b>time_seconds:</b> The integer seconds portion of the timestamp for the raster. This needs to be combined with <em>time_fraction</em> to derive the full timestamp. This field corresponds to the <em>time_fraction</em> field of the raster header in the TLD file. However, the value is sometimes adjusted in the EDB file to incorporate an offset when the EAARL system time is out of sync with real time.</li>
<li><b>time_fraction:</b> The fractional seconds portion of the timestamp for the raster. This needs to be combined with <em>time_seconds</em> to derive the full timestamp. The value is stored in a hardware-specific format; to convert to seconds, multiply by 1.6e-6.</li>
<li><b>record_offset:</b> Offset in bytes to the start of the record in the TLD file.</li>
<li><b>record_length:</b> Length in bytes of the record in the TLD file. This corresponds to the <em>record_length</em> field of the record header in the TLD file.</li>
<li><b>file_index:</b> Index into the filenames section of the EDB file for the TLD file that has this record. The index is one-based.</li>
<li><b>pulse_count:</b> Number of pulses in the raster. This corresponds to the <em>pulse_count</em> field of the raster header in the TLD file.</li>
<li><b>digitizer:</b> Specifies which digitizer was used for the waveforms, either 0 or 1. This corresponds to the <em>digitizer</em> field of the raster header in the TLD file.</li>
</ul>
<h3>Filename</h3>
<p>Each filename has a variable length. Filenames are stored as length-prefixed strings. The length prefix is 2 bytes and is followed by the string without a null terminator.</p>
<table class="doxtable">
<tr>
<th>Item </th><th>Format </th><th>Size  </th></tr>
<tr>
<td>length </td><td>uint16_t </td><td>2 bytes </td></tr>
<tr>
<td>filename </td><td>char[] </td><td>varies per length </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
